DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'ConsoleApp1.BloggingContext'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202109142032379_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[Blogs] (
        [BlogId] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Blogs] PRIMARY KEY ([BlogId])
    )
    CREATE TABLE [dbo].[Posts] (
        [PostId] [int] NOT NULL IDENTITY,
        [Title] [nvarchar](max),
        [Content] [nvarchar](max),
        [BlogId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Posts] PRIMARY KEY ([PostId])
    )
    CREATE INDEX [IX_BlogId] ON [dbo].[Posts]([BlogId])
    ALTER TABLE [dbo].[Posts] ADD CONSTRAINT [FK_dbo.Posts_dbo.Blogs_BlogId] FOREIGN KEY ([BlogId]) REFERENCES [dbo].[Blogs] ([BlogId]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202109142032379_InitialCreate', N'ConsoleApp1.BloggingContext',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D64AB297D6B077917592C2E8260EA264D15B404B63852845AA2415D828FA643DF491FA0A1DEACF1225F96FD79B160182989CF9389CF96638E3FCF3D7DFA3F7CB98392F2015157CEC9E0D4E5D07782042CAA3B19BEAC59B1FDDF7EFBEFD667415C64BE75329F7D6C8A1265763F759EB64E8792A788698A8414C03299458E84120628F84C23B3F3DFDC93B3BF300215CC4729CD17DCA358D21FB801F27820790E894B01B110253C53AEEF819AA734B6250090960ECA2AC120C2E92E4CC752E182568820F6CE13A8473A1894603878F0A7C2D058FFC0417087B582580720BC21414860FD7E2BBDEE1F4DCDCC15B2B965041AAB488F7043C7B5B38C5B3D50F72AD5B390DDD7685EED52B73EBCC7563F7031391EBD8070D274C1AA186570746F6C4A9AD9C5481477E981FDC4D994E258C39A45A1276E2DCA57346835F60F5207E033EE62963758BD026DC6B2CE0D29D140948BDBA8745CDCE69E83A5E53D7B3952B554B2FBFCD94EBB7E7AE738B469039832AF0B59BFB5A48F8193848A221BC235A83C4B84D43C85CD7B2C03ACFFC2E4F43A661B6B8CE0D597E041EE9E7B18B7FBACE355D4258AE14163C728AC9854A5AA6D03AE496BCD028B3CF3AEE4E28AD5CE71E58B6AB9E6992B37E60769EF2E85E4B11DF0B5688678B4F0F4446A0D15261EFF822958165C2C85B1367239D0CCCAE7432B2AF452773F621742AF5BE169D1EA86647E093750AC640A33D473F67B764DC95FB39B9F7A77E49F036F5CBA4D885FA174A89806647D7B8911FDBBCC0150F9D5E1B72879756A3CF91F034418AE39163F7879637BAC0AA5C5E83E5B76F829DB9765ECCF82530D0E05C04F9EB34212A20613B06E883B0B982A904D270983093C1989C94EB76DE511ED084B03E932D853D2ABF31AA82B7772E21016E32ACCFEF9F776E056F39699B4F465E8D34ED326AB2103540D60C883011B3EC5C769555EC668ACAAA8A04B4C962707DD035447C2DD6846EB0A5C5B4A672F1D4B49473DE5ACAB58B36118ABCACEDB792D6F6F7A6FCA98CACEC6B856B53C6D4D40BDFD8C46F5EA4A32E54515BF7A65EDE9C964DACD7D3C58E6E4892607C6B5D6DB1E2F8454BFBC6DFBFE58B730C2F501D9D5F656D7512BE4F24026BD73C09215C53A9F425D1644E4C5D9E84714BCCE6680F85CAD3EA346CC7A92456296DFEAE1EA84617DA91C085D235DE2636999F3DBC567CDB6AD9244118913D2FD544B034E69B0B423F4ADE0CD631F29536C2C8B3EC6F159D967B5A15BAE9EB9D2291E7CCA191C8327FFF4874ABF5F9B0ECB8EA5EECEEDE36A1147D541DA458DA1DA3EA92EA28D5E2EE38FB71EBA8CC6815315BA43ABD2A6656D11A15056497F9DCAA28B988EBA07B5E6868AA89BF521AE2811118F8BFB309A3996B4B811BC2E90294CE5B7F1727E5736BD2FFEF4CDD9E5221DB61F47EB551981ACF6E9D4EB635E71BA65FFE4264F04CE47731597E5F476A4F0AFB8D97AF36EE1DC5658D096F0F9F6D9DE23E0BAB832BADEE738A3DF072ECFE91A90C9DE9AF4FB9D689339398AD43E7D4F9738B3BBEE4709537965F73066A7696070C73070D513DFDCFD106A7FFC7B0D4EE57B78F42BD9350FE328DDD702E30AA397BBBE783AE21A97746EA82ED9C5A8E343ED5EFBCEE89B74D4CAD21EB384352BB8F408ED4FE1B80DC54345A4398FF0D70081AECA864A67C214A925A16952256C1BB014D42A4CE85D47441028DDB0128957D0FF689B01445AEE23984533E4B75926ABC32C473D6F802CF907DD3F9D924D8B479344BB22FAFBEC415D04C8A578019FF90521656765F77D4DD1E089345C5DB6662A9CD1B17AD2AA45BC177042ADC5725FF03C409433035E33E7981436C7B54F0112212ACCA76B01F647B209A6E1F5D52124912AB0263AD8F1F91C361BC7CF72FB363AF7E141B0000 , N'6.4.4')
END

IF @CurrentMigration < '202109142055300_AddUrlBlog'
BEGIN
    ALTER TABLE [dbo].[Blogs] ADD [Url] [nvarchar](max)
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202109142055300_AddUrlBlog', N'ConsoleApp1.BloggingContext',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D68AB397D6B077917592C2E8260EA264D15B404B63872845AA2415D828FA643DF491FA0A1DEACF1225F92FF1A6C5028B849CF9389CF96638A3FCF3D7DFC38FCB8839CF2015157CE4F67BA7AE033C1021E58B919BE8F9BB1FDD8F1FBEFD667819464BE74B21F7DEC8A1265723F749EB78E0792A788288A85E4403299498EB5E20228F84C23B3B3DFDC9EBF73D400817B11C677897704D23487FC15FC7820710EB84B06B110253F93AEEF829AA73432250310960E4A2AC120CCEE3B8EF3AE78C1234C10736771DC2B9D044A381830705BE96822FFC181708BB5FC5807273C214E4860FD6E2BBDEE1F4CCDCC15B2B165041A2B488F604ECBFCF9DE2D9EA07B9D62D9D866EBB44F7EA95B975EABA91FB898985EBD8070DC64C1AA19A577B46F6C4A9AC9C9481477E987FB89B309D48187148B424ECC4B94D668C06BFC0EA5EFC067CC413C6AA16A14DB8575BC0A55B2962907A7507F38A9D93D075BCBAAE672B97AA965E769B09D7EFCF5CE7068D20330665E02B37F7B590F03370904443784BB40689719B8490BAAE6181759EF9BF380D9986D9E23AD764F919F8423F8D5CFCD175AEE812C26225B7E081534C2E54D232816D873C48F6FA67DC9067BA487D609D762B9456AE73072CDD554F34CE32AB67761E33065D4911DD09968BA78B8FF7442E40A3A5C2DEF1452203CB84A1B726E746CA1A985D296B64DF8AB2E6EC43285BE87D2DCADE53CD8ECF598C81467B8E7ECE6E09BF2BF73372EF4FFD82E04DEA1749B10BF5CF9512014D8FAE70233BB67E814B1E3A9D36640E2FAC469F23E1698C14C72347EE0F0D6FB48195B9BC06CB6E5F07EBBB765E4CF90530D0E09C07D90B38262A20613306E883B0BE82A904D270983093C1989C94EB66DE511ED098B02E932D853D5E176354096FEF5C400CDC645897DF5F766E096F39699B4F865E8534CD326AB2103540560C586022A6D9B96C2BABD831E59555E5096893C5E0FAA02B88F85AAC095D634B836975E5FCA9692867BCB5942B17AD23E47959D96F24ADEDEF4DF9531A59DAD708D7A68CA9A8E7BEB1895FBF484B5D28A3B6EE7FBDAC012E1A65AFA3531E5E9338C6F8563AE77CC5F1F3B6F99DBF7F5B1965185EA05ABACBD2DAF2247C9FC802AC5DF324847045A5D2174493193175791C460D319BA31D142A4EABD2B019A7825885B4F9B97CA06A9D6E4B02E74A57789BC8647EFAF05AF16DAAA5D30A614476BC5463C192886F2E08DD2859C359C5C856764748BBC92A40BAD0D41F7AD6FD1B45ABE1DE4685AFC76AA7486639776824D3CAB17F24DBD5BA3C58746C5527B6777F9B50F23EAC0A922FED8E51765955947271779CFDB8795466348AA02D529E5E1643ABE80DF302B4CB3704AB226522AE83EE79A6A1A946FE4A69887A46A0E7FFCEC68CA6AE2D04AE09A773503A1B1D5C9CE6CFACAF11FF9D2F039E5221DBE1F3C09B8DEBD47876EB74B3ADB9DF30A1F36722832722BF8BC8F2FB2AD29E53F81E38FB8DB96F36761EC5F5B549F345BEB7A6C91761B570AED1054FB0175F8EDC3F52958133F9F531D33A71A612B37EE09C3A7F6E71C76B0E795983FB3567B17A877BC05079D030D7D1871D6D80FB7F0C6DCDBE79FB48D63991652FDCC80D6702A39AB1B77D4E691BD63A67B536D8D6E9E948635CF5CEEBDE7CDBE4D618F68E33AC35FB11E448E52F1FC84D45176B08F377100E418D1DA5CC84CF454152CBA242C42A78D7A04988D439979ACE49A0713B00A5D2EF715F084B50E4329A4138E1D344C789C62B433463B50F8986EC9BCE4F27D2BACDC3699C7E447B8D2BA09914AF0053FE29A12C2CEDBE6AA9BB1D10268BF2B7CDC4529B376EB12A916E04DF1128775F99FCF710C50CC1D494FBE4190EB1ED41C16758906055B495DD20DB035177FBF08292852491CA31D6FAF82B72388C961FFE05840654AE001C0000 , N'6.4.4')
END

IF @CurrentMigration < '202109142115137_AlterPostTitle'
BEGIN
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Posts')
    AND col_name(parent_object_id, parent_column_id) = 'Title';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Posts] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Posts] ALTER COLUMN [Title] [nvarchar](200) NULL
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202109142115137_AlterPostTitle', N'ConsoleApp1.BloggingContext',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D68A934B6BD8BBC83A496174130751B2E82DA0A5B143942255920A6C147DB21EFA487D850EF5678992FCB7F1A6C5028B849CF9389CF96638A3FCF3D7DFC30FCB88392F2015157CE4F67BA7AE033C1021E58B919BE8F9BB1FDD0FEFBFFD667815464BE77321776EE45093AB91FBAC753CF03C153C4344542FA281144ACC752F10914742E19D9D9EFEE4F5FB1E20848B588E33BC4FB8A611A4BFE0AF63C103887542D88D0881A97C1D77FC14D5B92511A898043072515609061771DC779D0B46099AE0039BBB0EE15C68A2D1C0C1A3025F4BC1177E8C0B843DAC6240B939610A72C3076BF15DEF707A66EEE0AD150BA820515A447B02F6CF73A778B6FA41AE754BA7A1DBAED0BD7A656E9DBA6EE47E6462E13AF64183319346A8E6D59E913D712A2B2765E0911FE61FEE264C2712461C122D093B71EE9219A3C12FB07A10BF011FF184B1AA456813EED51670E94E8A18A45EDDC3BC62E724741DAFAEEBD9CAA5AAA597DD66C2F5F999EBDCA21164C6A00C7CE5E6BE16127E060E926808EF88D620316E931052D7352CB0CE33FF17A721D3305B5CE7862C3F015FE8E7918B3FBACE355D4258ACE4163C728AC9854A5A26B0ED9047C95EFF8C5BF24217A90FACD3EE84D2CA75EE81A5BBEA99C65966F5CCCE53C6A06B29A27BC172F174F1E981C80568B454D83BBE4864609930F4D6E4DC485903B32B658DEC5B51D69C7D08650BBDAF45D907AAD926CE622D7905CE620C34DA73F4DCD82DE177E57E46EEFDA95F10BC49FD222976A1FE855222A0E9D1156E64C7D62F70C543A7D386CCE185D5E873243C8D91E278E4C8FDA1E18D36B03297D760D9EDEB607DD7CE8B29BF04061A9C8B207B01C74405246CC6007D10D6573095401A0E13663218939372DDCC3BCA031A13D665B2A5B0C7EB628C2AE1ED9D4B88819B0CEBF2FB979D5BC25B4EDAE693A157214DB38C9A2C440D90150316988869762EDBCA2A764C7965557902DA6431B83EE80A22BE166B42D7D8D2605A5D397F6A1ACA196F2DE5CA45EB08795E56F61B496BFB7B53FE944696F635C2B529632AEAB96F6CE2D72FD25217CAA8ADFB5F2F6B808B46D9EBE8948737248E31BE95CE395F71FCBC6D7EE7EFDF5646198617A896EEB2B4B63C09DF27B2006BD73C09215C53A9F425D164464C5D1E875143CCE66807858AD3AA346CC6A92056216D7E2E1FA85AA7DB92C0B9D235DE2632999F3EBC567C9B6AE9B44218911D2FD558B024E29B0B42374AD6705631B295DD11D26EB20A902E34F5879E75FF46D16AB8B751E1EBB1DA299259CE1D1AC9B472EC1FC976B52E0F161D5BD589EDDDDF2694BC0FAB82E44BBB63945D5615A55CDC1D673F6E1E95198D22688B94A797C5D02A7AC3BC00EDF20DC1AA489988EBA07B5E6868AA91BF521AA29E11E8F9BFB331A3A96B0B811BC2E91C94CE4607EC9DFB67D6D788FFCE97014FA990EDF079E0CDC6756A3CBB75BAD9D6DC6F98D0F90B91C13391DF4564F97D1569CF297C0F9CFDC6DC371B3B8FE2FADAA459F8AC396BEE17066BB0FCA290B6D0AFD1104FB02D5F8EDC3F52958133F9F529D33A71A6120BC0C03975FEDCE299D79CF7B25EF76B8E65F566F780F9F2A0B9AEA3253BDA2CF7FF98DF9A2DF4F6E9AC7338CB1EBB911BCE044635636FFBC8D236B7758E6D6DB0AD83D49126BAEA9DD76DFAB621AE31F71D676E6BB626C891CA1F41909B8A2ED610E64F221C821A3B4A99099F8B82A49645858855F06E409310A97321359D9340E376004AA59FE63E1396A0C855348370C2A7898E138D578668C66ADF140DD9379D9F0EA7759B87D338FD9EF61A574033295E01A6FC63425958DA7DDD52773B204C16E5CF9C89A536CFDD625522DD0ABE2350EEBE32F91F208A1982A929F7C90B1C62DBA3824FB020C1AAE830BB41B607A2EEF6E125250B49229563ACF5F157E470182DDFFF0BD80BEE1B0B1C0000 , N'6.4.4')
END

IF @CurrentMigration < '202109142119320_AddPostAbstract'
BEGIN
    ALTER TABLE [dbo].[Posts] ADD [Abstract] [nvarchar](max)
    UPDATE dbo.Posts SET Abstract = LEFT(Content, 100) WHERE Abstract IS NULL
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202109142119320_AddPostAbstract', N'ConsoleApp1.BloggingContext',  0x1F8B0800000000000400D559CD6EE33610BE17E83B083AB545D68A934B6BD8BBF03A496174130751B2E82DA0A5B143942255920A6C147DB21EFA487D850EF56789B2FC9738691120B049CEC7E1CC37C319FA9FBFFEEE7F5A44CC7906A9A8E003B7DB39751DE08108299F0FDC44CF3EFCE87EFAF8ED37FDCB305A385F8B75E7661D4A7235709FB48E7B9EA782278888EA443490428999EE0422F24828BCB3D3D39FBC6ED703847011CB71FA7709D73482F40B7E1D091E40AC13C2AE45084CE5E338E3A7A8CE0D8940C52480818B6B9560308CE3AEEB0C1925A8820F6CE63A8473A18946057B0F0A7C2D059FFB310E1076BF8C01D7CD0853902BDE5B2DDFF50CA767E60CDE4AB0800A12A545B42760F73C378A678B1F645AB7341A9AED12CDAB97E6D4A9E906EE6726E6AE636FD41B316916D5ACDA316B4F9CCAC849E978E487F9C3D984E944C28043A2256127CE6D326534F80596F7E237E0039E3056D50875C2B9DA000EDD4A1183D4CB3B9855F41C87AEE3D5653D5BB814B5E4B2D38CB93E3F739D1B54824C19948EAF9CDCD742C2CFC041120DE12DD11A24FA6D1C426ABA8606D67EE67FB11B320DA3C575AEC9E20BF0B97E1AB8F8D175AEE802C26224D7E081530C2E14D232816D9B3C48F6FA7BDC90673A4F6D60ED762B9456AE73072C9D554F34CE22AB63661E33065D4911DD09962F4F071FEF899C83464D853DE38B4406960A7D6F45CE8D943530BB52D6AC7D2FCA9ABD0FA16C21F75694BDA79A6DE22CE69257E02CFA40A33E478F8DDD027E33C670AA9009C111946D0DB22C8AF68FB122929A315644DF2E3136544A0434DDBA42C26CDBFA012E79E8B4EA9019ABD01AED859145638C25DC72E0FED0B0C63AB03269ACC0B2D3D7C1BAAE1D80137E010C3438C320BB6A474405246CFA006D10D6473066419A6021CCA40AF43DE5BA19E094073426AC4D654B608F6BCC2855C2DB3317100337A1DC66F797ED5BC25B46DA6693BE57214D335F9B704709901505E61844691A58ACCBDF589AE5295CE5C16393C5E0FAA02B88782DAD085D634B836975E1FC4E6B0867BCB5842B07AD23E47159996F04AD6DEF4DF1532A59EAD770D7A688A988E7B6B1895F3FC89ABC507A6D55687B59A55D54E45E4B49DEBF26718CFEAD94E8F988E3E7F5F9077FFFFA35CA30BC40AD29634B6DCB9DF0222473B066CDDD13C215954A5F104DA6C4A4E951183596D91C6DA150B15B95864D3F15C42A569BCFE54D582BA9D704702E7485A7894CE4A737BCE5DFA658DA16114664CB9538122C89F8E684D08E9255B6558C6C647784B46CAD02A4034DF9BE679DBF91B41AE66D64F8BAAF76F2641673877A32CD1CFB7B72BD589B058BD2B06AC4F565E62694BCE0AB82E443BB6394E55C15A51CDC1DE775B8B92AD8AA38ABD137E658239DDA4BCADDCBB46AA5CF7E9ECA7679F6B0725BB6C475D044CF343479CD5F2A0D51C72CE8F8BFB311A3A9938A05D784D319289D753B58EE77CFAC0794FFCE6386A754C87678D178B717066A2CBBB521DBB31FA93E2AF06722832722BF8BC8E2FB2AD29E0F077BE0ECD799BF5BA77C14D3D79AE3C266CDF6783F3758BDF08B5CBA867E8DD27A8C05FE62E0FE918AF49CF1AF8F99D489339198007ACEA9F3E78B9BE45720D4216D685682BF65B758AFC10F687B0F6A375B2AC5A3B598FF8FB6B259D96F6F1A5B7BC6ECE61CB8E154A05733F2AEEFA4D6B593ADDDE43AD8B5FDDD911ACDEA9957DDC3B6DEB2D18E1EA79D6CD639C891CA8F40C84D45E72B08F3931087A0C68E72CD98CF4441524BA3628995C4AE419310A933949ACE3099E174004AA5AF7D5F094B70C965348570CC27898E138D478668CA6A6FAA86EC9BF64F7BE6BACEFD499C3EF3BDC611504D8A478009FF9C5016967A5F3593781B8489A2FCCE34BED4E6EE9C2F4BA41BC17704CACD5706FF3D4431433035E13E798643747B50F005E6245816E56A3BC87647D4CDDEBFA0642E49A4728C953C7E450E87D1E2E3BF801D9C830B1D0000 , N'6.4.4')
END

